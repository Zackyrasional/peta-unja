<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peta Kampus Universitas Jambi</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Simple Line Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.min.css">
    <!-- Bootstrap CSS untuk font standar -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    
    <style>

        header h1 {
            font-size: 30px; /* Ubah ukuran font sesuai kebutuhan */
        }

        body{
            background-image: url('background.jpg'); /* Path atau URL gambar */
            background-size: cover; /* Menyesuaikan gambar agar menutupi seluruh layar */
            background-repeat: no-repeat; /* Agar gambar tidak berulang */
            background-position: center; /* Menempatkan gambar di tengah */
            
        }
        /* Pastikan seluruh elemen halaman menempati 100% tinggi */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }

        header {
            background-color: #ff6a26;
            color: white;
            text-align: center;
            padding: 10px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        /* Setel map-container agar full height */
        .map-container {
            padding-top: 60px; /* Jarak untuk header */
            display: none;
            height: 100%;
            box-sizing: border-box;
        }

        .map {
            width: 100%;
            height: calc(100vh - 60px); /* Sesuaikan tinggi untuk menyesuaikan header */
            margin-top: 0;
        }

        /* Atur margin di atas search-bar agar tidak menyentuh header */
        .search-bar {
            margin: 27px 10px 10px; /* Tambahkan margin atas */
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 70px; /* Di bawah header */
            width: calc(100% - 40px); /* Ruang untuk margin di kiri dan kanan */
            z-index: 1000;
        }

        .search-bar select, .search-bar input {
            margin-right: 10px;
            padding: 8px;
            font-size: 16px;
            width: 100%;
        }

        .button {
            background-color: #ff6a26;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }

        .back-button {
            background-color: #ff6a26;
            color: white;
            border: none;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
        }

        /* CSS untuk tampilan login container */
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
        }

        /* Gaya untuk judul role */
        .role-title h2 {
            margin-bottom: 20px;
            font-size: 24px;
            color: #ffffff;
        }

        /* Gaya untuk tombol pilihan role */
        .role-buttons {
            display: flex;
            gap: 10px; /* Jarak antar tombol */
        }

        .guest-options {
            display: none;
        }
    </style>
</head>
<body>

<header>
    <h1>PETA KAMPUS UNIVERSITAS JAMBI, MENDALO</h1>
</header>

<!-- Pilihan Tamu atau Anggota -->
<div class="login-container">
    <!-- Tambahkan elemen untuk judul -->
    <div class="role-title">
        <h2>Pilih Masuk Sebagai: </h2>
    </div>

    <!-- Kelompokkan tombol pilihan tamu dan anggota dalam div -->
    <div class="role-buttons">
        <button class="button" onclick="selectRole('guest')">Tamu</button>
        <button class="button" onclick="selectRole('member')">Anggota</button>
    </div>
</div>

<!-- Tampilan Peta dan Opsi Tamu -->
<div class="map-container">
    <div class="search-bar">
        <!-- Input untuk Autocomplete Pencarian -->
        <input id="autocomplete" type="text" placeholder="Cari lokasi...">

        <!-- Dropdown untuk Tamu -->
        <div class="guest-options">
            <select id="location-select" onchange="showAdditionalOptions()">
                <option value="">Pilih Lokasi Acara</option>
                <option value="buildingA">SI Wisuda </option>
            </select>

            <!-- Dropdown sub-lokasi untuk tamu -->
            <select id="option-select" style="display: none;" onchange="goToSelectedOption()">
                <option value="">Pilih tindakan</option>
                <option value="direct">Langsung ke Tempat</option>
                <option value="parking">Tempat Parkir</option>
            </select>
        </div>

        <!-- Tombol kembali di pojok kanan atas -->
        <button class="back-button" onclick="goBack()">Kembali</button>
    </div>

    <div id="campus-map" class="map"></div>
</div>

<script>
    let map, infoWindow, directionsService, directionsRenderer, autocomplete;
    let userLocation;

    // Daftar lokasi utama dan sub-lokasi
    const subLocations = {
        buildingA: {
            direct: { name: "Gedung A", lat: -1.614850, lng: 103.519641 },
            parking: { name: "Parkir Gedung A", lat: -1.615081, lng: 103.519658 }
        }
    };

    function selectRole(role) {
        document.querySelector('.login-container').style.display = 'none';
        document.querySelector('.map-container').style.display = 'block';

        if (role === 'guest') {
            document.querySelector('.guest-options').style.display = 'flex';
        } else {
            document.querySelector('.guest-options').style.display = 'none';
        }
        
        initMap();
    }

    function goBack() {
        document.querySelector('.map-container').style.display = 'none';
        document.querySelector('.login-container').style.display = 'flex';
    }

    function initMap() {
        directionsService = new google.maps.DirectionsService();
        directionsRenderer = new google.maps.DirectionsRenderer();

        map = new google.maps.Map(document.getElementById("campus-map"), {
            center: { lat: -1.607697, lng: 103.520159 },
            zoom: 18,
            mapTypeId: google.maps.MapTypeId.HYBRID, // Setel mode awal ke satelit
            mapTypeControl: true,
            mapTypeControlOptions: {
                style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
                mapTypeIds: ['roadmap', 'satellite', 'hybrid', 'terrain'],
                position: google.maps.ControlPosition.LEFT_CENTER // Kontrol posisi di kiri tengah
            },
            zoomControl: true,
        });

        directionsRenderer.setMap(map);
        infoWindow = new google.maps.InfoWindow();

        // Coba mendeteksi lokasi pengguna
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    userLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude,
                    };
                    map.setCenter(userLocation);
                    addMarker(userLocation, "Lokasi Anda");
                },
                () => handleLocationError()
            );
        } else {
            handleLocationError();
        }

        // Setup Google Places Autocomplete
        autocomplete = new google.maps.places.Autocomplete(
            document.getElementById("autocomplete"), 
            { fields: ["place_id", "geometry", "name"] }
        );
        autocomplete.addListener("place_changed", onPlaceChanged);
    }

    function handleLocationError() {
        // Lokasi default jika geolokasi gagal
        const defaultLocation = { lat: -1.607697, lng: 103.520159 };
        map.setCenter(defaultLocation);
        userLocation = defaultLocation;
    }

    function addMarker(position, title) {
        const marker = new google.maps.Marker({
            position: position,
            map: map,
            title: title,
            icon: {
                url: "https://maps.google.com/mapfiles/ms/icons/blue-dot.png",
                scaledSize: new google.maps.Size(30, 30),
            },
        });

        const infoWindow = new google.maps.InfoWindow({
            content: `<h3>${title}</h3>`,
        });

        marker.addListener("click", () => {
            infoWindow.open(map, marker);
        });
    }

    function onPlaceChanged() {
        const place = autocomplete.getPlace();
        if (place.geometry) {
            map.panTo(place.geometry.location);
            addMarker(place.geometry.location, place.name);
            calculateRoute(place.geometry.location.lat(), place.geometry.location.lng());
        } else {
            alert("Lokasi tidak ditemukan. Silakan pilih lokasi yang valid.");
        }
    }

    function showAdditionalOptions() {
        const locationSelect = document.getElementById("location-select").value;
        const optionSelect = document.getElementById("option-select");

        if (locationSelect) {
            optionSelect.style.display = "inline-block";
        } else {
            optionSelect.style.display = "none";
        }
    }

    function goToSelectedOption() {
        const location = document.getElementById("location-select").value;
        const option = document.getElementById("option-select").value;

        if (location && option) {
            const selectedSubLocation = subLocations[location][option];
            map.setCenter({ lat: selectedSubLocation.lat, lng: selectedSubLocation.lng });
            addMarker({ lat: selectedSubLocation.lat, lng: selectedSubLocation.lng }, selectedSubLocation.name);
            calculateRoute(selectedSubLocation.lat, selectedSubLocation.lng);
        }
    }

    function calculateRoute(destinationLat, destinationLng) {
        const request = {
            origin: userLocation,
            destination: { lat: destinationLat, lng: destinationLng },
            travelMode: google.maps.TravelMode.DRIVING,
        };

        directionsService.route(request, (result, status) => {
            if (status === "OK") {
                directionsRenderer.setDirections(result);
            } else {
                alert("Tidak dapat menampilkan rute. Silakan coba lokasi lain atau periksa koneksi internet Anda.");
            }
        });
    }
</script>

<script>
    window.onload = function() {
        var script = document.createElement("script");
        script.src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyDeFkdDHn66CIPxCbbcccyoSOFwiTbiXgU&libraries=places&callback=initMap";
        script.async = true;
        script.defer = true;
        document.body.appendChild(script);
    };
</script>

</body>
</html>
